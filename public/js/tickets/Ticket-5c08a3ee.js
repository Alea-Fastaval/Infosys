import{g as se,a as oe,d as ne,e as ie,u as de,h as ue,b as O}from"./users.service-cc472843.js";import{_ as re,n as pe,r as d,o as ve,a as ce,b as m,c as me,d as L,e as ge,g as o,w as u,h as R,i as $,F as _e,j as B,t as r,q as J,f as a,k as N,l as D,p as ke,m as ye}from"./index-bfb621a3.js";const i=U=>(ke("data-v-a76bd147"),U=U(),ye(),U),be={style:{display:"flex",float:"right",gap:"1rem"}},fe={style:{display:"flex"}},xe={style:{width:"100%","white-space":"pre-wrap"}},we={class:"ticket-details"},Te=i(()=>a("span",null,"Oprettet:",-1)),he=i(()=>a("span",null,"Ændret:",-1)),Ve=i(()=>a("span",null,"Prioritet:",-1)),Ue=i(()=>a("span",null,"Oprettet af:",-1)),Ce=i(()=>a("span",null,"Udføres af:",-1)),Ie={class:"p-text-secondary"},Me=i(()=>a("h4",null,"Rediger opgave",-1)),Le={style:{display:"grid","grid-template-columns":"minmax(400px, 800px) minmax(150px, 300px)",gap:"1rem"}},De={style:{display:"flex","flex-direction":"column"}},Se=i(()=>a("label",{class:"help-text"},"Navn/Titel",-1)),Oe=i(()=>a("label",{class:"help-text"},"Opgavebeskrivelse",-1)),Re={style:{display:"flex","flex-direction":"column","background-color":"#eee",padding:"1rem",height:"min-content","padding-bottom":"1.5rem","border-radius":"4px"}},$e=i(()=>a("label",{class:"help-text"},"Status",-1)),Be=i(()=>a("label",{class:"help-text"},"Kategori",-1)),Ne=i(()=>a("label",{class:"help-text"},"Prioritet",-1)),ze=i(()=>a("label",{class:"help-text"},"Udføres af",-1)),Fe={style:{display:"inline-flex",gap:"1rem"}},Ge=i(()=>a("label",{class:"help-text"},"Besked",-1)),qe={style:{display:"inline-flex",gap:"1rem"}},Ee={__name:"Ticket",setup(U){const z=pe(),F=d(),l=d(),s=d(),b=d(),G=d(),f=d(!1),x=d(!1),q=d("new"),_=d(!1),w=d(),k=d(),v=d();let E=[{label:"Lukket",options:[{label:"Annulleret",open:0,status:0},{label:"Godkendt",open:0,status:1},{label:"Kan/vil ikke lave",open:0,status:2}]},{label:"Åben",options:[{label:"Oprettet",open:1,status:0},{label:"Startet",open:1,status:1},{label:"Skal testes",open:1,status:2},{label:"Venter",open:1,status:3}]}];const Q=()=>{var T,p,C,I,M,h,g,V,y,e;const n=(l==null?void 0:l.value.open)===1?(p=(T=v.value.tickets)==null?void 0:T.open)==null?void 0:p.da:(I=(C=v.value.tickets)==null?void 0:C.closed)==null?void 0:I.da,t=l.value.open===1?(g=(h=(M=v.value.tickets)==null?void 0:M.status)==null?void 0:h.open[l.value.status])==null?void 0:g.da:(e=(y=(V=v.value.tickets)==null?void 0:V.status)==null?void 0:y.closed[l.value.status])==null?void 0:e.da;return{severity:l.value.open===1?"success":"secondary",value:`${n} - ${t}`}},W=()=>({severity:"info",value:v.value.tickets.category[l.value.category].da}),X=()=>{s.value={...s.value,open:w.value.open,status:w.value.status}},Y=async()=>{_.value=!0,await de(s.value).then(async()=>{await j(),f.value=!1,_.value=!1})},Z=async()=>{_.value=!0,await ue(b.value).then(async()=>{await A(),x.value=!1,_.value=!1})},ee=()=>{s.value={...l.value},f.value=!0,w.value=E[l.value.open].options[l.value.status]},P=n=>{b.value={...n,ticket:l.value.id},q.value=n?"edit":"new",x.value=!0},j=async()=>await ne(z.params.id).then(n=>l.value=n.tickets[z.params.id]),A=async()=>await ie(l.value.id).then(n=>G.value=n.messages),te=()=>!s.value.name||!s.value.description||!s.value.assignee,ae=()=>!b.value,le=n=>k.value.find(t=>t.id===n).name;return ve(async()=>{await se().then(n=>v.value=n),k.value=Object.values(await oe()),await j(),await A()}),ce(async()=>{var n;return F.value=(n=window==null?void 0:window.infosys)==null?void 0:n.user_id}),(n,t)=>{const K=m("RouterLink"),T=m("Tag"),p=m("Button"),C=m("Card"),I=m("Timeline"),M=m("InputText"),h=m("Textarea"),g=m("Dropdown"),V=m("Dialog"),y=me("tooltip");return L(),ge(_e,null,[o(K,{to:"/",style:{"margin-bottom":"1rem",display:"inline-flex"}},{default:u(()=>[B("← Tilbage ")]),_:1}),k.value&&l.value?(L(),R(C,{key:0},{title:u(()=>{var e;return[B(r((e=l.value)==null?void 0:e.name)+" ",1),o(T,J(Q(),{rounded:""}),null,16),o(T,J(W(),{rounded:""}),null,16),a("div",be,[N(o(p,{icon:"pi pi-file-edit",onClick:t[0]||(t[0]=c=>ee()),outlined:"",raised:"",rounded:"",severity:"secondary",size:"small"},null,512),[[y,"Rediger opgave",void 0,{top:!0}]]),N(o(p,{icon:"pi pi-comment",raised:"",rounded:"",size:"small",onClick:t[1]||(t[1]=c=>P())},null,512),[[y,"Ny besked",void 0,{top:!0}]])])]}),content:u(()=>{var e,c,H;return[a("div",fe,[a("div",xe,r(((e=l.value)==null?void 0:e.description)??"Ingen beskrivelse"),1),a("div",we,[Te,a("span",null,r(l.value.created?D(O)(l.value.created):"Ukendt"),1),he,a("span",null,r(l.value.last_edit?D(O)(l.value.last_edit):"-"),1),Ve,a("span",null,r(((H=(c=v.value)==null?void 0:c.tickets)==null?void 0:H.priority[l.value.priority].da)??"Ukendt"),1),Ue,a("span",null,r(k.value.find(S=>S.id===l.value.creator).name??"Ukendt"),1),Ce,a("span",null,r(k.value.find(S=>S.id===l.value.assignee).name??"Ukendt"),1)])])]}),_:1})):$("",!0),o(I,{value:G.value,style:{"padding-top":"1rem"}},{opposite:u(e=>[a("small",Ie,r(le(e.item.user))+" | "+r(D(O)(e.item.posted)),1)]),marker:u(e=>[e.item.user===F.value?N((L(),R(p,{key:0,class:"timeline-btn",icon:"pi pi-file-edit",raised:"",rounded:"",size:"small",onClick:c=>P(e.item)},null,8,["onClick"])),[[y,"Rediger din besked",void 0,{top:!0}]]):$("",!0)]),content:u(e=>[B(r(e.item.message),1)]),_:1},8,["value"]),s.value?(L(),R(V,{key:1,visible:f.value,"onUpdate:visible":t[11]||(t[11]=e=>f.value=e),modal:""},{header:u(()=>[Me]),footer:u(()=>[a("div",Fe,[o(p,{severity:"info",text:"",label:"Luk",icon:"pi pi-times",onClick:t[9]||(t[9]=e=>f.value=!1)}),o(p,{label:"Gem",raised:"",disabled:te(),onClick:t[10]||(t[10]=e=>Y()),loading:_.value},null,8,["disabled","loading"])])]),default:u(()=>[a("div",Le,[a("div",De,[Se,o(M,{modelValue:s.value.name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value.name=e),modelModifiers:{trim:!0},required:"",style:{width:"400px"}},null,8,["modelValue"]),Oe,o(h,{modelValue:s.value.description,"onUpdate:modelValue":t[3]||(t[3]=e=>s.value.description=e),modelModifiers:{trim:!0},autoResize:!0,rows:10,style:{width:"100%"},required:""},null,8,["modelValue"])]),a("div",Re,[$e,o(g,{class:"status-select",modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e),options:D(E),optionLabel:"label",optionGroupLabel:"label",optionGroupChildren:"options",onChange:t[5]||(t[5]=e=>X())},null,8,["modelValue","options"]),Be,o(g,{modelValue:s.value.category,"onUpdate:modelValue":t[6]||(t[6]=e=>s.value.category=e),options:v.value.tickets.category.map((e,c)=>({label:e.da,value:c})),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),Ne,o(g,{modelValue:s.value.priority,"onUpdate:modelValue":t[7]||(t[7]=e=>s.value.priority=e),options:v.value.tickets.priority.map((e,c)=>({label:e.da,value:c})),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),ze,o(g,{modelValue:s.value.assignee,"onUpdate:modelValue":t[8]||(t[8]=e=>s.value.assignee=e),options:k.value,resetFilterOnHide:!0,optionLabel:"name",optionValue:"id",filter:""},null,8,["modelValue","options"])])])]),_:1},8,["visible"])):$("",!0),o(V,{visible:x.value,"onUpdate:visible":t[14]||(t[14]=e=>x.value=e),modal:"",style:{width:"100%","max-width":"750px",margin:"0 10px"}},{header:u(()=>[a("h4",null,r(q.value==="new"?"Ny besked":"Rediger besked"),1)]),footer:u(()=>[a("div",qe,[o(p,{severity:"info",text:"",label:"Luk",icon:"pi pi-times",onClick:t[13]||(t[13]=e=>x.value=!1)}),o(p,{label:"Gem",raised:"",disabled:ae(),onClick:Z,loading:_.value},null,8,["disabled","loading"])])]),default:u(()=>[Ge,o(h,{modelValue:b.value.message,"onUpdate:modelValue":t[12]||(t[12]=e=>b.value.message=e),modelModifiers:{trim:!0},autoResize:!0,rows:10,style:{width:"100%"},required:""},null,8,["modelValue"])]),_:1},8,["visible"])],64)}}},Ae=re(Ee,[["__scopeId","data-v-a76bd147"]]);export{Ae as default};
