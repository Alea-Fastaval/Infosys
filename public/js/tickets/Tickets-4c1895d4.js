import{g as Z,a as ee,f as te,c as ae,b as A}from"./users.service-cc472843.js";import{T as oe,_ as le,u as se,r as s,o as ne,a as ie,b as p,c as re,d as w,e as S,f as o,g as a,w as i,h as de,i as ue,F as pe,j as L,t as P,k as F,l as h,p as ce,m as ve}from"./index-bfb621a3.js";const K=d=>{const k=new oe("da-DK");if(!d)return"";const _=d.toString().length<=10?d*1e3:d;return k.format(new Date(_))};const r=d=>(ce("data-v-859e7436"),d=d(),ve(),d),me={style:{display:"inline-flex",gap:"1rem"}},ge={style:{display:"inline-flex",gap:"0.5rem"}},fe=r(()=>o("label",{for:"showOnlyOpen"},"Åbne opgaver",-1)),_e={style:{display:"inline-flex",gap:"0.5rem"}},ye=r(()=>o("label",{for:"showOnlyMine"},"Mine opgaver",-1)),be={class:"p-input-icon-left"},we=r(()=>o("i",{class:"pi pi-search"},null,-1)),he=r(()=>o("p",{style:{"text-align":"center"}},"Ingen opgaver fundet.",-1)),ke=r(()=>o("h4",null,"Opret opgave",-1)),xe={style:{display:"grid","grid-template-columns":"minmax(400px, 800px) minmax(150px, 300px)",gap:"1rem"}},Ve={style:{display:"flex","flex-direction":"column"}},Te=r(()=>o("label",{class:"help-text"},"Navn/Titel",-1)),Oe=r(()=>o("label",{class:"help-text"},"Opgavebeskrivelse",-1)),Ce={style:{display:"flex","flex-direction":"column","background-color":"#eee",padding:"1rem",height:"min-content","padding-bottom":"1.5rem","border-radius":"4px"}},De=r(()=>o("label",{class:"help-text"},"Kategori",-1)),Ie=r(()=>o("label",{class:"help-text"},"Prioritet",-1)),Ue=r(()=>o("label",{class:"help-text"},"Udføres af",-1)),Se={style:{display:"inline-flex",gap:"1rem"}},Le={__name:"Tickets",setup(d){const k=se(),_=s(),x=s(),v=s(),M=s(),c=s(),m=s(!1),V=s(!0),T=s(!1),O=s(""),g=s(""),f=s(""),C=s(0),D=s(0),y=s(""),N=async()=>{await te().then(l=>{_.value=Object.values(l.tickets).map(e=>(e.category=c.value.tickets.category[e.category].da,e.creator=v.value.find(n=>n.id===e.creator).name,e.assignee=v.value.find(n=>n.id===e.assignee).name,e.status=e.open===1?c.value.tickets.status.open[e.status].da:c.value.tickets.status.closed[e.status].da,e)),b()})},b=()=>x.value=_.value.filter(l=>j(l)&&z(l)&&q(l)),j=l=>l.name.toLowerCase().includes(O.value.toLowerCase())??!0,z=l=>V.value?l.open===1:!0,q=l=>T.value?l.assignee===M.value:!0,H=()=>{g.value="",f.value="",m.value=!0},E=async()=>{await ae({name:g.value,description:f.value,priority:C.value,category:D.value,assignee:y.value}).then(async()=>{await N(),m.value=!1})},G=()=>!g.value||!f.value||!y.value,J=l=>{const e=l.data.id;k.push({path:`tickets/show/${e}`})};return ne(async()=>{c.value=await Z(),v.value=Object.values(await ee()),await N()}),ie(async()=>{var l;M.value=(l=v.value.find(e=>{var n;return e.id===((n=window==null?void 0:window.infosys)==null?void 0:n.user_id)}))==null?void 0:l.name}),(l,e)=>{const n=p("Button"),R=p("InputSwitch"),B=p("InputText"),Q=p("Toolbar"),u=p("Column"),W=p("DataTable"),X=p("Textarea"),I=p("Dropdown"),Y=p("Dialog"),$=re("tooltip");return w(),S(pe,null,[o("div",null,[a(n,{icon:"pi pi-plus",size:"small",raised:"",onClick:e[0]||(e[0]=t=>H()),label:"Opret"})]),a(Q,null,{start:i(()=>[o("div",me,[o("div",ge,[a(R,{inputId:"showOnlyOpen",modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),onChange:e[2]||(e[2]=t=>b())},null,8,["modelValue"]),fe]),o("div",_e,[a(R,{inputId:"showOnlyMine",modelValue:T.value,"onUpdate:modelValue":e[3]||(e[3]=t=>T.value=t),onChange:e[4]||(e[4]=t=>b())},null,8,["modelValue"]),ye])])]),end:i(()=>[o("span",be,[we,a(B,{class:"search-field",modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=t=>O.value=t),modelModifiers:{trim:!0},onKeyup:e[6]||(e[6]=t=>b()),placeholder:"Søg i opgaver"},null,8,["modelValue"])])]),_:1}),x.value?(w(),de(W,{key:0,onRowClick:J,value:x.value,rows:10,rowHover:!0,sortOrder:-1,rowsPerPageOptions:[5,10,20,50,100],size:"small","sort-field":"last_edit",paginatorTemplate:" FirstPageLink PrevPageLink CurrentPageReport NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"{first}-{last} ud af {totalRecords}",paginator:"",stripedRows:"",removableSort:""},{empty:i(()=>[he]),default:i(()=>[a(u,{field:"id",header:"ID",sortable:""}),a(u,{field:"category",header:"Kategori",sortable:""}),a(u,{field:"name",header:"Navn",sortable:""}),a(u,{field:"priority",header:"Prioritet",sortable:""},{body:i(t=>[L(P(c.value.tickets.priority[t.data.priority].da),1)]),_:1}),a(u,{field:"creator",header:"Opretter",sortable:""}),a(u,{field:"assignee",header:"Udfører",sortable:""}),a(u,{field:"status",header:"Status",sortable:""}),a(u,{field:"last_edit",header:"Ændret",sortable:""},{body:i(t=>[F((w(),S("div",null,[L(P(h(K)(t.data.last_edit)),1)])),[[$,h(A)(t.data.last_edit),void 0,{bottom:!0}]])]),_:1}),a(u,{field:"created",header:"Oprettet",sortable:""},{body:i(t=>[F((w(),S("div",null,[L(P(h(K)(t.data.created)),1)])),[[$,h(A)(t.data.created),void 0,{bottom:!0}]])]),_:1})]),_:1},8,["value"])):ue("",!0),a(Y,{visible:m.value,"onUpdate:visible":e[14]||(e[14]=t=>m.value=t),modal:"",class:"newTicket"},{header:i(()=>[ke]),footer:i(()=>[o("div",Se,[a(n,{severity:"info",text:"",label:"Luk",icon:"pi pi-times",onClick:e[12]||(e[12]=t=>m.value=!1)}),a(n,{label:"Opret opgave",raised:"",disabled:G(),onClick:e[13]||(e[13]=t=>E())},null,8,["disabled"])])]),default:i(()=>[o("div",xe,[o("div",Ve,[Te,a(B,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=t=>g.value=t),modelModifiers:{trim:!0},required:"",style:{width:"400px"}},null,8,["modelValue"]),Oe,a(X,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=t=>f.value=t),modelModifiers:{trim:!0},autoResize:!0,rows:10,style:{width:"100%"},required:""},null,8,["modelValue"])]),o("div",Ce,[De,a(I,{modelValue:D.value,"onUpdate:modelValue":e[9]||(e[9]=t=>D.value=t),options:c.value.tickets.category.map((t,U)=>({label:t.da,value:U})),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),Ie,a(I,{modelValue:C.value,"onUpdate:modelValue":e[10]||(e[10]=t=>C.value=t),options:c.value.tickets.priority.map((t,U)=>({label:t.da,value:U})),optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),Ue,a(I,{modelValue:y.value,"onUpdate:modelValue":e[11]||(e[11]=t=>y.value=t),options:v.value,resetFilterOnHide:!0,optionLabel:"name",optionValue:"id",filter:""},null,8,["modelValue","options"])])])]),_:1},8,["visible"])],64)}}},Ne=le(Le,[["__scopeId","data-v-859e7436"]]);export{Ne as default};
